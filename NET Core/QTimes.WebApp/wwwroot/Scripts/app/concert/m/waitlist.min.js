function ReservationViewModel(){var n=this;n.GuestTypeId=ko.observable(3);n.Size=ko.observable(1);n.Guests=ko.observableArray([]);n.Seatings=ko.observableArray([]);n.LimitSize=ko.observable(5);n.SpotName=ko.observable();n.SpotValue=ko.observable();n.SeatNo=ko.observable();n.GuestName=ko.observable();n.MobileNumber=ko.observable();n.Email=ko.observable();n.IsDlscanEnabled=ko.observable(!1);n.Dob=ko.observable();n.FamilyName=ko.observable();n.FirstName=ko.observable();n.State=ko.observable();n.City=ko.observable();n.Zip=ko.observable();n.Address=ko.observable();n.FacePhotoImageBase64=ko.observable();n.SeatMap=ko.observable();n.EnableTimeExpiration=ko.observable();n.SetSizeValue=function(t,i){n.Size($(i.currentTarget).text());$(i.currentTarget).parent().siblings().removeClass("active");$(i.currentTarget).parent().addClass("active");n.AddGuests(n.Size()-1)};n.AddGuests=function(t){n.Guests([]);for(var i=0;i<t;i++)n.Guests.push(new Guest({Name:"",MobileNo:"",SeatNo:1,SeatName:"",IsMainGuest:!1})),window.intlTelInput(document.querySelector("#mob_id"+(i+2)),{separateDialCode:!0})};n.OnChangeSpot=function(t,i){var u=$(i.currentTarget).siblings("select.spots"),r;for(n.SpotName($(i.currentTarget).find("option:selected").text()),u.empty(),u.append(new Option("Choose...","")),r=1;r<=n.SpotValue();r++)u.append(new Option(r,r))};n.OnSeatSelect=function(t,i){n.EnableTimeExpiration()&&($(".loader").removeClass("hidden"),n.SeatNo($(i.currentTarget).find("option:selected").text()),$.get(webserviceURL+`concerts/${concertId}/events/${eventId}/seatlocks/${t.SpotName()+"-"+t.SeatNo()}`,function(){}).always(function(){$(".loader").addClass("hidden")}).fail(function(n,t,i){ShowErrorMessage(n,t,i)}))};n.AddReservation=function(){$(".loader").removeClass("hidden");$.ajax({type:"POST",url:webserviceURL+`concerts/${concertId}/events/${eventId}/reservations`,data:{ConcertEventId:eventId,GuestTypeId:n.GuestTypeId(),Size:n.Size(),Guests:n.Guests(),MainGuestName:n.GuestName(),MainGuestMobileNo:n.MobileNumber(),MainGuestEmail:n.Email(),MainGuestSeatName:n.SpotName(),MainGuestSeatNo:n.SeatNo(),Dob:n.Dob,FamilyName:n.FamilyName(),FirstName:n.FirstName(),State:n.State(),City:n.City(),Zip:n.Zip(),Address:n.Address(),Email:n.Email(),FacePhotoImageBase64:n.FacePhotoImageBase64()},success:function(n){document.cookie="pass="+n.data.PassUrl+"; path=/";location.href="/m/concert/confirmation/"+n.data.ConcertEventReservationId},error:function(n,t,i){$(".loader").addClass("hidden");ShowErrorMessage(n,t,i)}})};n.LoadSeatings=function(){$(".loader").removeClass("hidden");const t=this;var i=webserviceURL+`concerts/${concertId}/events/${eventId}/seatings`;$.get(i,function(i){var e=$.map(i.data.Seatings,function(n){return new Seating(n)}),f;n.Seatings(e);n.EnableTimeExpiration(i.data.EnableTimeExpiration);n.SeatMap(i.data.SeatMapFullPath);n.LimitSize(i.data.MaxGroupSize==0?1:i.data.MaxGroupSize);$("#size1").parent().addClass("active");const r=getUrlParam("refId"),u=getUrlParam("phone"),o=getUrlParam("email");t.IsDlscanEnabled(i.data.IsDlscanEnabled);i.data.IsDlscanEnabled&&r===null?(f=`${dlScanAppUrl}?callback=${window.location.href}`,window.location.replace(f)):r&&$.getJSON(`${webserviceURL}DriverLicense?id=${r}`,function(n){t.GuestName(n.data.Document.FullName);t.Dob(n.data.Document.DOB);t.FamilyName(n.data.Document.FamilyName);t.FirstName(n.data.Document.FirstName);t.State(n.data.Document.State);t.City(n.data.Document.City);t.Zip(n.data.Document.Zip);t.Address(n.data.Document.Address);t.FacePhotoImageBase64(n.data.FacePhotoFromDocument);t.MobileNumber(u);t.Email(o);iti.setNumber("+"+u)})}).always(function(){$(".loader").addClass("hidden")})};n.LoadSeatings()}function Guest(n){var t=this;t.Name=ko.observable(n.Name);t.MobileNo=ko.observable(n.MobileNo);t.Email=ko.observable(n.Email);t.SeatNo=ko.observable(n.SeatNo);t.SeatName=ko.observable(n.SeatName);t.IsMainGuest=ko.observable(n.IsMainGuest);t.SpotValue=ko.observable(n.SeatNo);t.OnChangeSpot=function(n,i){var u,r;if(i)for(u=$(i.currentTarget).siblings("select.spots"),t.SeatName($(i.currentTarget).find("option:selected").text()),u.empty(),u.append(new Option("Choose...","")),r=1;r<=t.SpotValue();r++)u.append(new Option(r,r))};t.OnSeatSelect=function(n,i){reservationViewModel.EnableTimeExpiration()&&i&&($(".loader").removeClass("hidden"),t.SeatNo($(i.currentTarget).find("option:selected").text()),$.get(webserviceURL+`concerts/${id}/events/${id}/seatlocks/${n.SeatName()+"-"+n.SeatNo()}`,function(){}).always(function(){$(".loader").addClass("hidden")}).fail(function(n,t,i){ShowErrorMessage(n,t,i)}))}}function Seating(n){var t=this;t.Name=ko.observable(n.Name);t.Spots=ko.observable(n.Spots);t.SeatsPerSpot=ko.observable(n.SeatsPerSpot);t.CheckInTime=ko.observable(n.CheckInTime)}function getUrlParam(n){if(location.search==="")return null;const t=location.search.substring(1);if(t.includes("&")){const i=new URLSearchParams(t);return i.get(n)}const i=t.split("="),r=i[0],u=i[1];return r===n?u:null}var input,iti,reservationViewModel;$("body").addClass("waitlist2 waitlist3 waitlist4 guest-detail_body iti-mobile");input=document.querySelector("#mob_id");iti=window.intlTelInput(input,{separateDialCode:!0,utilsScript:"/content/intl-tel-input/js/utils.js"});$(".reserve_absolute1 .btn").click(function(n){n.preventDefault();$("#appHeader").text("GUEST DETAILS");$(".reserve_absolute2").show();$(".reserve_absolute1").hide();$(".reserve_absolute3").hide()});$(".reserve_absolute2 .front_arrow").click(function(n){n.preventDefault();$("#appHeader").text("NEW RESERVATION");$(".reserve_absolute1").show();$(".reserve_absolute2").hide();$(".reserve_absolute3").hide()});$(".seat-cg-btn a").click(function(n){n.preventDefault();$("#appHeader").text("Spot Map");$(".reserve_absolute1").hide();$(".reserve_absolute2").hide();$(".reserve_absolute3").show()});$(".cross-del").click(function(n){n.preventDefault();$("#appHeader").text("NEW RESERVATION");$(".reserve_absolute1").show();$(".reserve_absolute2").hide();$(".reserve_absolute3").hide()});reservationViewModel=new ReservationViewModel;ko.applyBindings(reservationViewModel);