function ReservationViewModel(){var n=this;n.GuestName=ko.observable();n.Size=ko.observable(1);n.Comments=ko.observable();n.MobileNumber=ko.observable();n.SelectedDate=ko.observable(moment().format("YYYY-MM-DD"));n.TimeFrom=ko.observable();n.TimeTo=ko.observable();n.Times=ko.observableArray([]);n.LimitSize=ko.observable(0);n.IsDlscanEnabled=ko.observable(!1);n.Dob=ko.observable();n.FamilyName=ko.observable();n.FirstName=ko.observable();n.State=ko.observable();n.City=ko.observable();n.Zip=ko.observable();n.Address=ko.observable();n.FacePhotoImageBase64=ko.observable();n.Email=ko.observable();n.Load=function(){var t=this;$(".loader").removeClass("hidden");$.ajax({type:"POST",url:webserviceURL+"reservation/business/"+id,data:{Id:id,Date:n.SelectedDate()},success:function(i){var e=$.map(i.data.TimeSlots,function(n){return new TimeSlot(n)}),f;n.Times(e);n.LimitSize(i.data.LimitSize==0?1:i.data.LimitSize);$(".loader").addClass("hidden");const r=getUrlParam("refId"),u=getUrlParam("phone"),o=getUrlParam("email");t.IsDlscanEnabled(i.data.IsDlscanEnabled);i.data.IsDlscanEnabled&&r===null?(f=`${dlScanAppUrl}?callback=${window.location.href}`,window.location.replace(f)):r&&$.getJSON(`${webserviceURL}DriverLicense?id=${r}`,function(n){t.GuestName(n.data.Document.FullName);t.Dob(n.data.Document.DOB);t.FamilyName(n.data.Document.FamilyName);t.FirstName(n.data.Document.FirstName);t.State(n.data.Document.State);t.City(n.data.Document.City);t.Zip(n.data.Document.Zip);t.Address(n.data.Document.Address);t.FacePhotoImageBase64(n.data.FacePhotoFromDocument);t.MobileNumber(u);t.Email(o);iti.setNumber("+"+u)})},error:function(n,t,i){$(".loader").addClass("hidden");ShowErrorMessage(n,t,i)}})};n.SetSizeValue=function(t,i){n.Size($(i.currentTarget).text());$(i.currentTarget).parent().siblings().removeClass("active");$(i.currentTarget).parent().addClass("active")};n.Add=function(){if(!iti.isValidNumber())return NotifyErrorMessage("Invalid Mobile No., Please enter valid number."),!1;$(".loader").removeClass("hidden");$.ajax({type:"POST",url:webserviceURL+"reservation/addreservation",data:{BusinessDetailId:id,Name:n.GuestName(),MobileNo:iti.getNumber(),GuestTypeId:3,Size:n.Size(),Date:n.SelectedDate(),TimeFrom:n.TimeFrom(),TimeTo:n.TimeTo(),Comments:n.Comments(),Dob:n.Dob,FamilyName:n.FamilyName(),FirstName:n.FirstName(),State:n.State(),City:n.City(),Zip:n.Zip(),Address:n.Address(),Email:n.Email(),FacePhotoImageBase64:n.FacePhotoImageBase64()},success:function(n){document.cookie="pass="+n.data.PassUrl+"; path=/";location.href="/m/reservation/confirmation/"+n.data.ReservationId},error:function(n,t,i){$(".loader").addClass("hidden");ShowErrorMessage(n,t,i)}})};n.OnReservationDateChange=function(){var t=event.target.value;n.SelectedDate(t);n.Load()};n.Load()}function TimeSlot(n){var t=this;t.OpenHourFrom=ko.observable(n.OpenHourFrom);t.OpenHourTo=ko.observable(n.OpenHourTo);t.SpotLeft=ko.observable(n.SpotLeft);t.Time=ko.computed(function(){return moment("1990-01-01 "+n.OpenHourFrom).format("hh:mm A")+" - "+moment("1990-01-01 "+n.OpenHourTo).format("hh:mm A")});t.SetTimeSlot=function(n,t){$(t.currentTarget).siblings().removeClass("active");$(t.currentTarget).addClass("active");$(".input_chk").removeClass("tick");$(t.currentTarget).find(".input_chk").addClass("tick");reservationViewModel.TimeFrom(n.OpenHourFrom());reservationViewModel.TimeTo(n.OpenHourTo())};t.IsHourPassed=ko.computed(function(){var i=new Date,t=moment(reservationViewModel.SelectedDate()),r=moment(t.year()+"-"+(t.month()+1)+"-"+t.date()+" "+n.OpenHourTo);if(i>r)return!0;!1})}function getUrlParam(n){if(location.search==="")return null;const t=location.search.substring(1);if(t.includes("&")){const i=new URLSearchParams(t);return i.get(n)}const i=t.split("="),r=i[0],u=i[1];return r===n?u:null}$("body").addClass("commonctn waitlist2 waitlist3");$('[type="date"].date_picker_show').prop("min",function(){return(new Date).toJSON().split("T")[0]});var reservationViewModel=new ReservationViewModel;ko.applyBindings(reservationViewModel);